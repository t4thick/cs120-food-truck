{% extends "staff_layout.html" %}
{% block staff_content %}

<!-- Add New Menu Item Section -->
<section class="panel-card" style="background: linear-gradient(135deg, #f0f9ff 0%, #fff 100%); border: 2px solid #2196F3;">
    <div class="panel-header">
        <div>
            <h2>‚ûï Add New Menu Item</h2>
            <p class="portal-note">Add a new meal, drink, or side to the menu</p>
        </div>
    </div>
    
    <div class="panel-body">
        <form action="{{ url_for('add_menu_item') }}" method="POST" enctype="multipart/form-data" class="menu-form">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <label for="name">Item Name *</label>
                    <input type="text" id="name" name="name" required placeholder="e.g., Classic Burger">
                </div>
                <div>
                    <label for="price">Price ($) *</label>
                    <input type="number" id="price" name="price" step="0.01" min="0" required placeholder="9.99">
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label for="description">Description *</label>
                <textarea id="description" name="description" rows="3" required placeholder="Describe the item..."></textarea>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <label for="category">Category *</label>
                    <select id="category" name="category" required>
                        <option value="Combo">Combo</option>
                        <option value="Main">Main</option>
                        <option value="Veg">Vegetarian/Vegan</option>
                        <option value="Side">Side</option>
                        <option value="Drink">Drink</option>
                    </select>
                </div>
                <div>
                    <label for="vegan">Vegan?</label>
                    <select id="vegan" name="vegan">
                        <option value="false">No</option>
                        <option value="true">Yes</option>
                    </select>
                </div>
                <div>
                    <label for="allergens">Allergens (comma-separated)</label>
                    <input type="text" id="allergens" name="allergens" placeholder="gluten, dairy, egg">
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label for="image">Item Image</label>
                <input type="file" id="image" name="image" accept="image/*">
                <small style="color: #666; display: block; margin-top: 4px;">Upload a photo of the item (JPG, PNG, etc.)</small>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="button" style="background: #2196F3;">
                    ‚ûï Add Menu Item
                </button>
            </div>
        </form>
    </div>
</section>

<!-- Current Menu Items -->
{% for category_name, items in categories.items() %}
<section class="panel-card">
    <div class="panel-header">
        <div>
            <h2>üçΩÔ∏è {{ category_name }} ({{ items|length }} items)</h2>
        </div>
    </div>
    
    <div class="panel-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
            {% for item in items %}
            <div class="menu-item-card" style="border: 1px solid #e0e0e0; border-radius: 12px; padding: 16px; background: #fff;">
                <div style="display: flex; gap: 12px; margin-bottom: 12px;">
                    <div style="width: 80px; height: 80px; border-radius: 8px; overflow: hidden; background: #f5f5f5; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        {% if item.image %}
                        <img src="{{ url_for('static', filename='images/' + item.image) }}" 
                             alt="{{ item.name }}" 
                             style="width: 100%; height: 100%; object-fit: cover;">
                        {% else %}
                        <span style="font-size: 32px;">üçΩÔ∏è</span>
                        {% endif %}
                    </div>
                    <div style="flex: 1; min-width: 0;">
                        <h3 style="margin: 0 0 4px; font-size: 16px; font-weight: 600; color: #1a1a1a;">{{ item.name }}</h3>
                        <p style="margin: 0 0 8px; font-size: 14px; color: #666; line-height: 1.4;">{{ item.description }}</p>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <span style="font-size: 18px; font-weight: 700; color: #d6001c;">${{ "%.2f"|format(item.price) }}</span>
                            {% if item.vegan %}
                            <span style="padding: 2px 8px; background: #e8f5e9; color: #2e7d32; border-radius: 4px; font-size: 11px; font-weight: 600;">VEGAN</span>
                            {% endif %}
                        </div>
                        {% if item.allergens %}
                        <div style="margin-top: 8px;">
                            <small style="color: #d32f2f; font-size: 11px;">
                                <strong>Allergens:</strong> {{ item.allergens|join(", ") }}
                            </small>
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="display: flex; gap: 8px; margin-top: 12px; padding-top: 12px; border-top: 1px solid #f0f0f0;">
                    <form action="{{ url_for('edit_menu_item', item_id=item.item_id) }}" method="GET" style="flex: 1;">
                        <button type="submit" class="button" style="background: #ff9800; width: 100%; padding: 8px;">
                            ‚úèÔ∏è Edit
                        </button>
                    </form>
                    <form action="{{ url_for('delete_menu_item', item_id=item.item_id) }}" method="POST" style="flex: 1;" 
                          onsubmit="return confirm('Are you sure you want to delete {{ item.name }}? This cannot be undone.');">
                        <button type="submit" class="button" style="background: #dc3545; width: 100%; padding: 8px;">
                            üóëÔ∏è Delete
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endfor %}

{% if not categories %}
<section class="panel-card">
    <div class="panel-empty">
        <span>üçΩÔ∏è</span>
        <p>No menu items yet. Add your first item above!</p>
    </div>
</section>
{% endif %}

<style>
.menu-form label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: #333;
    font-size: 14px;
}

.menu-form input[type="text"],
.menu-form input[type="number"],
.menu-form input[type="file"],
.menu-form textarea,
.menu-form select {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    font-family: inherit;
    box-sizing: border-box;
    transition: border-color 0.2s;
}

.menu-form input:focus,
.menu-form textarea:focus,
.menu-form select:focus {
    outline: none;
    border-color: #2196F3;
}

.menu-item-card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transform: translateY(-2px);
    transition: all 0.2s;
}
</style>

{% endblock %}

